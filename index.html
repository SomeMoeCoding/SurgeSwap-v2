<!DOCTYPE html>
<html id="html" lang="en" dir="ltr" data-theme="dark">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Dutch Decentralized Applications">
    <meta name="description" content="Surge Swap">
    <meta property="og:description" content="The Surge Protocol Swap dApp" />
    <meta property="og:title" content="Surge Swap" />
    <title>Surge Swap</title>

    <meta property="og:image" itemprop="image" content="" />
    <meta property="og:url" content="https://www.surgeprotocol.io" />
    <meta property="og:image" itemprop="image" content="https://surgedev1.vercel.app/img/og_image.png" />
    <meta property="og:url" content="https://www.surgeprotocol.io" />
    <link rel="shortcut icon" href="https://surgedev1.vercel.app/img/icon/favicon.png">
    <link rel="apple-touch-icon" href="https://surgedev1.vercel.app/img/icon/favicon.png">
    <link rel="canonical" href="" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:domain" content="https://www.surgeprotocol.io" />
    <meta name="twitter:title" content="Surge Swap" />
    <meta name="twitter:description" content="The Surge Protocol Swap dApp" />
    <meta name="twitter:image" content="https://surgedev1.vercel.app/img/og_image.png" />

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
    <link href='css/site.css' rel='stylesheet'>
</head>
<body>
    <video autoplay loop muted controls webkit-playsinline playsinline id="myVideo">
        <source src="img/bg.mp4" type="video/mp4">
    </video>
    <div class="content">
        <nav class="navbar navbar-expand-lg navbar-dark px-sm-4 px-2">
            <div class="container-fluid">
                <a class="navbar-brand" href="/"><img class="brand-img" src="img/Logo.png" /></a>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item mx-xl-4 mx-3">
                            <a class="nav-link active" aria-current="page" href="/">Swap</a>
                        </li>
                        <li class="nav-item mx-xl-4 mx-3">
                            <a target="_blank" class="nav-link" href="http://Chart.surgeprotocol.io">Chart</a>
                        </li>
                        <!--<li class="nav-item mx-xl-4 mx-3">
                            <a target="_blank" class="nav-link" href="http://Dash.surgeprotocol.io">Dashboard</a>
                        </li>-->
                    </ul>
                </div>
                <div class="d-flex flex-row">
                    <form class="d-flex align-items-center">
                        <div class="dropdown">
                            <a class="nav-link text-white cp fw-500 mx-sm-3 mx-0" data-bs-toggle="dropdown">
                                <i class='bx bx-dots-horizontal-rounded fs-4 mt-1' style="vertical-align:middle;"></i>
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1" style="padding:0;">
                                <li class="hide-pc"><a target="_blank" href="http://Chart.surgeprotocol.io" class="dropdown-item">Chart</a></li>
                                <!--<li class="hide-pc"><a target="_blank" href="http://Dash.surgeprotocol.io" class="dropdown-item">Dashboard</a></li>-->
                                <li><a target="_blank" href="https://docs.surgeprotocol.io/" class="dropdown-item">Docs</a></li>
                                <li><a target="_blank" href="https://docs.surgeprotocol.io/guides/surgeswap" class="dropdown-item">Tutorials</a></li>
                                <li><a target="_blank" href="https://linktr.ee/SURGEPROTOCOL" class="dropdown-item">Linktree</a></li>
                            </ul>
                        </div>

                        <div class="dropstart">
                            <a id="btn-chain" class="nav-link text-white cp fw-500 mx-sm-3 mx-2" data-bs-toggle="dropdown">
                                <span class="hide-sm mt-1" style="display: inline-block; vertical-align: middle; margin-right:0.5rem">
                                    <i class='bx bx-chevron-down fs-4' style="vertical-align:middle; margin-right:6px;"></i>
                                    <span id="chainname">Smart Chain</span>
                                </span>
                                <img id="chainlogo" class="chain-logo" src="img/bsc.png" />
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1" style="padding:0;">
                                <li id="bsc"><a class="dropdown-item" onclick="SwapChain(rpcs.BSC);"><img class="chain-logo2" src="img/bsc.png" /> <span style="margin-left: 5px; display:inline-block; margin-top:3px;">Smart Chain</span></a></li>
                                <li id="eth"><a class="dropdown-item" onclick="SwapChain(rpcs.Ethereum);"><img class="chain-logo2" src="img/eth.png" /> <span style="margin-left: 5px; display:inline-block; margin-top:3px;">Ethereum</span></a></li>
                                <li id="poly"><a class="dropdown-item" onclick="SwapChain(rpcs.Polygon);"><img class="chain-logo2" src="img/poly2.png" /><span style="margin-left: 10px; display:inline-block; margin-top:3px;">Polygon</span></a></li>
                                <li id="arbi"><a class="dropdown-item" onclick="SwapChain(rpcs.Arbitrum);"><img class="chain-logo2" src="img/arbi.png" /><span style="margin-left: 10px; display:inline-block; margin-top:3px;">Arbitrum</span></a></li>
                                <li id="testnet"><a class="dropdown-item" onclick="SwapChain(rpcs.BSCTest);"><img class="chain-logo2" src="img/testnet.png" /><span style="margin-left: 10px; display:inline-block; margin-top:3px;">Test Net</span></a></li>
                            </ul>
                        </div>

                        <a id="btn-connect" class="nav-link text-white cp fw-500" data-bs-toggle="modal" data-bs-target="#walletModal">
                            <i class="hide-sm bx bxs-wallet fs-4" style="vertical-align:middle; margin-bottom:4px;margin-right:8px;"></i>
                            Connect
                        </a>

                        <div class="btn-group dropstart">
                            <span id="btn-disconnect" class="btn-nav px-sm-3 px-2" data-bs-toggle="dropdown" style="display:none; padding-right:0!important;">
                                <i class="bx bx bxs-wallet fs-3" style="vertical-align: middle; margin-bottom: 4px; margin-right: 8px; margin-top:7px;"></i>
                            </span>
                            <ul id="disconnect-menu" class="dropdown-menu fs-4 p-0" aria-labelledby="dropdownMenuLink">
                                <li style="border-bottom: solid rgba(60, 253, 0, 0.4) 1px;">
                                    <span id="walletaddress2" class="dropdown-item pb-2 text-center fs-5">0x02b10...7767</span>
                                </li>
                                <li>
                                    <a class="dropdown-item pt-2 text-center fs-5" onclick="Disconnect();">
                                        Disconnect
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </form>
                    <button class="navbar-toggler d-none" type="button" style="border:none;">
                        <i class='bx bx-menu fs-1 text-white' style="margin-top:3px;"></i>
                    </button>
                </div>
            </div>
        </nav>

        <section class="swap">
            <div class='container' style="padding-top:25vh">
                <div class="d-flex justify-content-center align-items-center flex-column">
                    <div class="text-center mb-5">
                        <img src="img/Heading.png" />
                    </div>
                    <div class="d-flex balanceInfo">
                        <p class="text-white-50 mb-1 fs-6">Balance:&nbsp;</p>
                        <p class="text-white-50 mb-1 fs-6" id="balanceInput">0.000</p>
                    </div>
                    <div class="input-group" id="inputForm">
                        <input id="inputField" onclick="this.select();" type="number" class="form-control" placeholder="0.00">
                        <div class="input-group-append">
                            <span onclick="OpenTokenWindow(0);" class="input-group-text fw-700 cp">BNB<img src="img/bsc.png" /></span>
                        </div>
                    </div>
                    <div class="perc-btns d-flex my-2 justify-content-end w-100" style="max-width: 495px;">
                        <button onclick="SetValueInput(0.25);" class="mx-1 btn-perc">25%</button>
                        <button onclick="SetValueInput(0.50);" class="mx-1 btn-perc">50%</button>
                        <button onclick="SetValueInput(0.75);" class="mx-1 btn-perc">75%</button>
                        <button onclick="SetValueInput(1.00);" class="mx-1 btn-perc">100%</button>
                    </div>
                    <div class="text-center" style="margin-bottom:-27.5px; margin-top:4px; z-index:2;">
                        <img src="img/swap.png" class="cp" onclick="SwitchInputOutput();" />
                    </div>
                    <div class="d-flex balanceInfo">
                        <p class="text-white-50 mb-1 fs-6">Balance:&nbsp;</p>
                        <p class="text-white-50 mb-1 fs-6" id="balanceOutput">0.000</p>
                    </div>
                    <div class="input-group" id="outputForm">
                        <input id="outputField" onclick="this.select();" type="number" class="form-control" placeholder="0.00" aria-label="Recipient's username" aria-describedby="basic-addon2">
                        <div class="input-group-append">
                            <span onclick="OpenTokenWindow(1);" class="input-group-text fw-700 cp">SRG<img src="img/Token.png" /></span>
                        </div>
                    </div>
                    <div class="perc-btns d-flex my-2 justify-content-end w-100" style="max-width: 495px;">
                        <button onclick="SetValueOutput(0.25);" class="mx-1 btn-perc">25%</button>
                        <button onclick="SetValueOutput(0.50);" class="mx-1 btn-perc">50%</button>
                        <button onclick="SetValueOutput(0.75);" class="mx-1 btn-perc">75%</button>
                        <button onclick="SetValueOutput(1.00);" class="mx-1 btn-perc">100%</button>
                    </div>
                    <p class="text-white-50 mt-4 text-center" style="max-width:500px; width:100%; padding-left:67px;">
                        <span id="amountOut1">1.00 BNB = 0.00 SRG</span>
                        <span class="fr">
                            <i data-bs-toggle="modal" data-bs-target="#historyModal" class="bx bx-history text-success fs-4" style="margin-left:0.5rem; margin-bottom:1px; vertical-align:bottom;"></i>
                            <i data-bs-toggle="modal" data-bs-target="#optionsModal" class="bx bxs-cog text-success fs-4" style="margin-left:0.5rem; margin-bottom:1px; vertical-align:bottom;"></i>
                        </span>
                    </p>
                    <button id="btn-connect2" class="btn btn-success btn-block mt-2" data-bs-toggle="modal" data-bs-target="#walletModal">Connect Wallet</button>
                    <button id="btn-swap" class="btn btn-success btn-block mt-2" onclick="OpenVerifyModal();" style="display:none;">Surge Swap</button>
                    <button id="btn-approve" class="btn btn-success btn-block mt-2" onclick="Approve();" style="display:none;">Approve Token</button>
                </div>
            </div>
        </section>

        <footer class="mt-5">
            <div class="container text-center pt-5 mt-5">
                <a target="_blank" href="https://twitter.com/SURGEPROTOCOL" class="fs-2 text-white mx-3"><i class="bx bxl-twitter"></i></a>
                <a target="_blank" href="https://t.me/SURGEPROTOCOL" class="fs-2 text-white mx-3"><i class="bx bxl-telegram"></i></a>
                <a target="_blank" href="https://medium.com/@thesurgedefi" class="fs-2 text-white mx-3"><i class="bx bxl-medium"></i></a>
                <a target="_blank" href="https://www.youtube.com/@surgedefi" class="fs-2 text-white mx-3"><i class="bx bxl-youtube"></i></a>
                <a target="_blank" href="https://discord.gg/VkkX4pKB4U" class="fs-2 text-white mx-3"><i class="bx bxl-discord"></i></a>
            </div>
            <div class="container">
                <div class="d-flex flex-lg-row flex-column justify-content-center align-items-center pt-3">
                    <div class="text-center robo">
                        <p class="text-white-50">Copyright 2023 - <a href="https://surgeprotocol.io/" class="text-white-50 td-none">Surge Protocol</a></p>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <div class="modal fade" id="walletModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body">
                    <span style="float:right;"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span>
                    <br />
                    <h3 style="margin-left:1rem;" class="mb-3 text-center fw-600">Please connect a wallet</h3>
                    <div class="justify-content-center align-items-center text-center" style="padding:0; margin:0;">
                        <button onclick="Connect();" class="btn col-5 text-center mt-3 pt-3 pb-3" style="padding:0; margin:0;">
                            <img src="img/metamask.png">
                            <h6 class="pt-3 fw-600">MetaMask</h6>
                        </button>
                        <button onclick="ConnectWC();" class="btn col-5 text-center mt-3 pt-3 pb-3" style="padding:0; margin:0;">
                            <img src="img/wc.png">
                            <h6 class="pt-3 fw-600">Wallet Connect</h6>
                        </button>
                        <br />
                        <br />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="historyModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4">
                    <h4>Recent Transactions<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-start align-items-center" style="padding:0; margin:0;" id="historyContent">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="optionsModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4">
                    <h4>Settings<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-start align-items-center" style="padding:0; margin:0;">
                        <div id="gasOptions" class="mb-5">
                            <p class="text-white-50 mb-0">Gas Price</p>
                            <button id="gwei5" onclick="options.gwei=5;SetOptions();" class="btn btn-outline-success active mt-2">Default (5)</button>
                            <button id="gwei6" onclick="options.gwei=6;SetOptions();" class="btn btn-outline-success mt-2">Fast (6)</button>
                            <button id="gwei7" onclick="options.gwei=7;SetOptions();" class="btn btn-outline-success mt-2">Fastest (7)</button>
                        </div>
                        <p class="text-white-50 mb-0">Slippage Tolerance</p>
                        <div class="input-group input-trans" style="border-radius:0; border-bottom: 1px solid darkgrey;">
                            <input oninput="SetOptions();" id="slippage" type="number" class="form-control input-trans fs-2" value="15.00">
                            <div class="input-group-append">
                                <span class="input-group-text fs-2">%</span>
                            </div>
                        </div>
                        <!-- <p id="frontrun" class="text-warning mt-3"><i class='bx bxs-error mx-3' style="vertical-align: middle; margin-bottom: 3px;"></i>Your transaction may be frontrun</p>-->
                        <p class="text-white-50 mt-5 mb-0">Transaction deadline</p>
                        <div class="input-group input-trans mb-3" style="border-radius:0; border-bottom: 1px solid darkgrey;">
                            <input oninput="SetOptions();" id="deadline" type="number" class="form-control input-trans fs-2" value="30">
                            <div class="input-group-append">
                                <span class="input-group-text fs-6">minutes</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade pe-none" id="loadingModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4 text-center">
                    <h4>Confirm Transaction</h4>
                    <br />
                    <div class="justify-content-center align-items-center text-center" style="padding:0; margin:0;">
                        <img class="spinning my-3" src="img/Logo2.png" style="max-width:120px; max-height:120px;" />
                        <h6 class="mt-4">Waiting For Confirmation</h6>
                        <p class="mt-3 text-white-50" id="awaitTrade">Trading 1 SRG for 1 BNB</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="verifyModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4">
                    <h4>Confirm Swap<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-center align-items-center" style="padding:0; margin:0; text-align:left;" id="verifyContent">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4">
                    <h4>Transaction Submitted<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-center align-items-center text-center" style="padding:0; margin:0;">
                        <img class="my-3" src="img/Logo2.png" style="max-width:120px; max-height:120px;" />
                        <h5 class="mt-4">Transaction Submitted</h5>
                        <p class="mt-3 text-white-50"><a class="td-none" href="#" id="txnlink">View on BscScan <img style="max-height:20px; max-width:20px; margin-bottom:4px; margin-left:5px; filter: grayscale(1)" src="img/scan.png" /></a></p>
                        <button class="btn btn-outline-success mt-3" onclick="AddToken();" id="btn-AddWallet">Add SRG to Wallet</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="errorModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body px-4 p-3 p-sm-4">
                    <h4>Error<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-center align-items-center text-center" style="padding:0; margin:0;">
                        <i class="bx bx-x text-danger" style="font-size: 7rem;"></i>
                        <h5 class="mt-4">An Error has occured.</h5>
                        <p class="mt-3 text-white-50" id="errorMessage"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="selectionModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body">
                    <h4 class="px-4 pt-2">Select a Token<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="input-group-sm mx-3 mb-3">
                        <input id="inputSearch" type="text" class="form-control" placeholder="Search name or paste address" style="border: solid 1px grey; border-radius:15px;">
                    </div>
                    <div class="justify-content-start align-items-center" style="padding:0; margin:0; overflow:auto; max-height:400px;" id="tokenSearches">
                        <div class="d-flex flex-row justify-content-center text-center tokenrow cp p-2 px-3">
                            <p>Loading Data...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="importModal">
        <div class="modal-dialog modal-dialog-centered" style="max-width:500px;">
            <div class="modal-content">
                <div class="modal-body">
                    <h4 class="px-4 pt-2 pb-0 mb-0">Import a Token<span class="fr"><i class="bx bx-x fs-2 cp" data-bs-dismiss="modal"></i></span></h4>
                    <br />
                    <div class="justify-content-start align-items-center" style="padding:0; margin:0; overflow:auto; max-height:400px;" id="tokenSearches">
                        <div class="warning-box mt-0 p-3 px-3 mb-3">
                            <p class="mb-0">
                                <i class="bx bxs-error fs-3 text-warning"></i><br />
                                Anyone can create a token with malicious functions, even on Surge. It is important you make sure the code behind this contract address is verified and safe!

                                Do not approve any token before doing your own research on it. You are trading at your own risk at any given time. Approving a malicious contract can lead to permanent loss of your funds.
                            </p>
                        </div>
                        <div class="d-flex flex-row justify-content-between align-items-center p-2 px-3">
                            <div class="d-flex flex-row">
                                <div class="flex-column">
                                    <h6 class="mb-0 text-white" id="importSymbol">SRG</h6>
                                    <p class="mb-0 text-white-50" id="importName">Surge</p>
                                </div>
                            </div>
                            <a href="#" target="_blank" id="importExplorer" class="td-none d-flex flex-row">
                                <p class="mb-0" style="margin-top:2px;">View on Explorer</p>
                                <img class="mx-3" src="img/scan.png" style="width:25px; height:25px;" />
                            </a>
                        </div>
                        <div class="form-check form-switch mt-3 mx-3">
                            <input class="form-check-input" type="checkbox" id="researchCheck">
                            <label class="form-check-label mx-3 robo">I did my own research</label>
                        </div>
                        <button id="btn-import" disabled class="mt-4 btn btn-outline-danger btn-block">Import</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/3.0.0-rc.5/web3.min.js" integrity="sha512-jRzb6jM5wynT5UHyMW2+SD+yLsYPEU5uftImpzOcVTdu1J7VsynVmiuFTsitsoL5PJVQi+OtWbrpWq/I+kkF4Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://github.com/WalletConnect/walletconnect-monorepo/releases/download/1.4.1/web3-provider.min.js"></script>
    <script src="https://peterolson.github.io/BigInteger.js/BigInteger.min.js"></script>
    <script src="js/vars.js" type="text/javascript"></script>
    <script src="js/common.js" type="text/javascript"></script>
    <script src="js/connect.js" type="text/javascript"></script>
    <script src="js/swap.js" type="text/javascript"></script>

    <script>
        var selection = 0;
        var switching = false;
        var firstLoad = true;

        $(document).ready(async function () {
            await Init_Master();
            firstLoad = false;
        });

        $("#slippage").on("input", function () {
            var value = $("#slippage").val();
            if (isNumeric(value)) {
                if (!value.includes("%")) {
                    $("#slippage").append("%");
                }
            }
        });

        $("#inputSearch").on("input", async function () {
            InputSearchChanged();
        });

        $('#researchCheck').change(function () {
            if (this.checked) {
                $("#btn-import").attr("disabled", false);
            } else {
                $("#btn-import").attr("disabled", true);
            }
        });

        $("#balanceInput").text(inputToken.balance.toFixed(4));
        $("#balanceOutput").text(outputToken.balance.toFixed(4));

        $("#inputField").on("input", async function () {
            CheckAmountOut();
        });
        $("#outputField").on("input", async function () {
            CheckAmountOutReverse();
        });

        async function OpenVerifyModal() {
            var slippage = (100 - options.slippage) / 100;

            var html = `<div class="d-flex flex-row p-2 px-3 align-items-center justify-content-between text-center">
                                    <div class="d-flex flex-row align-items-center">
                                        <img class="search-icon" src="${inputToken.img}" style="max-height: 50px;max-width: 50px; margin-right:1.5rem">
                                        <p class="search-balance mb-0 mt-2 fs-4 text-white">${formatterFourDec.format($("#inputField").val())}</p>
                                    </div>
                                    <p class="mb-0 text-white-50 mt-2 mx-3 fs-4">${inputToken.symbol}</p>
                                </div>
                                <div class="text-center my-1">
                                    <i class='bx bx-down-arrow-alt fs-1 text-success'></i>
                                </div>`;

            html += `<div class="d-flex flex-row p-2 px-3 align-items-center justify-content-between text-center">
                                    <div class="d-flex flex-row align-items-center">
                                        <img class="search-icon" src="${outputToken.img}" style="max-height: 50px;max-width: 50px; margin-right:1.5rem">
                                        <p class="search-balance mb-0 mt-2 fs-4 text-white">${formatterFourDec.format($("#outputField").val())}</p>
                                    </div>
                                    <p class="mb-0 text-white-50 mt-2 mx-3 fs-4">${outputToken.symbol}</p>
                                </div>`;
            html += `<hr/>
                            <h6 class="px-3 text-white mt-4">Slippage: <span class='fr text-white-50'>${options.slippage}%</span></h6>
                            <h6 class="px-3 text-white mt-4">Min. Received: <span class='fr text-white-50'>${formatterFourDec.format(Number($("#outputField").val()) * slippage)} ${outputToken.symbol}</span></h6>
                            <button id="btn-swap2" class="btn btn-success btn-block mt-4" onclick="Swap();">Confirm Swap</button>`;

            $("#verifyContent").html(html);
            $("#verifyModal").modal("show");
        }

        async function LoadAmountsOutTooltip() {
            try {
                if (inputToken.ca == "") { return; }
                var inputType = GetCAType(inputToken.ca);
                var outputType = GetCAType(outputToken.ca);
                var result;
                var rounding = 2;

                switch (inputType) {
                    case "BNB":
                    case "tBNB":
                    case "ETH":
                        var multicall = outputType == "SRG20" ? true : false;
                        if (multicall) {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei("1")).call();
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(SRGOut).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei("1")).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(SRGOut) / Math.pow(10, decimals);
                        }
                        break;
                    case "SRG":
                        if (outputType == "SRG20") {
                            var decimals2 = await GetInputDecimals();
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut((1 * Math.pow(10, decimals2)).toString()).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var decimals = await GetInputDecimals();
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut((1 * Math.pow(10, decimals)).toString()).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        }
                        break;
                    case "SRG20":
                        var multicall = outputType == "BNB" || outputType == "ETH" ? true : false;
                        if (multicall) {
                            var decimals = await GetInputDecimals();
                            var SRGOut = await inputToken.contractChain.methods.getsrgAmountOut((1 * Math.pow(10, decimals)).toString()).call();
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut(SRGOut).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        } else {
                            var decimals = await GetInputDecimals();
                            var SRGOut = await inputToken.contractChain.methods.getsrgAmountOut((1 * Math.pow(10, decimals)).toString()).call();
                            var decimals2 = await GetOutputDecimals();
                            result = Number(SRGOut) / Math.pow(10, decimals2);
                        }
                        break;
                }

                $("#amountOut1").text(`1.00 ${inputToken.symbol} = ${(result).toFixed(rounding)} ${outputToken.symbol}`);
            }
            catch (error) {
                console.log(error);
                ShowError(error.message);
            }
        }

        async function CheckAmountOut() {
            var value = $("#inputField").val();
            if (inputToken.ca == "") { return; }
            if (value == "") { return; }
            var inputType = GetCAType(inputToken.ca);
            var outputType = GetCAType(outputToken.ca);
            var result = 0;
            var rounding = 2;

            try {
                if (Number(value) > inputToken.balance) {
                    $("#btn-swap").text("Insufficient Balance").attr("disabled", true);
                } else {
                    $("#btn-swap").text("Surge Swap").attr("disabled", false);
                }

                switch (inputType) {
                    case "BNB":
                    case "tBNB":
                    case "ETH":
                        var multicall = outputType == "SRG20" ? true : false;
                        if (multicall) {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei(value)).call();
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(SRGOut).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei(value)).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(SRGOut) / Math.pow(10, decimals);
                        }
                        break;
                    case "SRG":
                        if (outputType == "SRG20") {
                            var decimals2 = await GetInputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals2)));
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(valueInput.toString()).call();
                            var decimals = await GetOutputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var decimals = await GetInputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut(valueInput.toString()).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        }
                        break;
                    case "SRG20":
                        var multicall = outputType == "BNB" || outputType == "ETH" ? true : false;
                        if (multicall) {
                            var decimals = await GetInputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                            var SRGOut = await inputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut(SRGOut).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        } else {
                            if (outputType !== "SRG20") {
                                var decimals = await GetInputDecimals();
                                var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                                var SRGOut = await inputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                                var decimals2 = await GetOutputDecimals();
                                result = Number(SRGOut) / Math.pow(10, decimals2);
                            } else {
                                var decimals = await GetInputDecimals();
                                var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                                var SRGOut = await inputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                                var decimals2 = await GetOutputDecimals();
                                var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(SRGOut).call();
                                result = Number(TokenOut) / Math.pow(10, decimals2);
                            }
                        }
                        break;
                }
            } catch (error) {
                ShowError(error.message);
            }

            if (result <= 0) {
                $("#outputField").val("");
            } else {
                $("#outputField").val(result.toFixed(4));
            }

            return result;
        }

        async function CheckApproval() {
            try {
                if (account !== "") {
                    $("#btn-approve").hide();
                    $("#btn-connect2").hide();
                    $("#btn-swap").show();

                    var outputType = GetCAType(outputToken.ca);
                    var inputType = GetCAType(inputToken.ca);

                    if (outputType == "SRG20" && inputType == "SRG") {
                        var allowance = Number(await contractSurgeNW.methods.allowance(account, outputToken.ca).call());
                        if (allowance <= 0) {
                            $("#btn-approve").show();
                            $("#btn-connect2").hide();
                            $("#btn-swap").hide();
                        }
                    }

                    if (outputType == "SRG20" && inputType == "SRG20") {
                        var contract = GetMultiSendContract();
                        var allowance = Number(await inputToken.contractChain.methods.allowance(account, contract._address).call());
                        if (allowance <= 0) {
                            $("#btn-approve").show();
                            $("#btn-connect2").hide();
                            $("#btn-swap").hide();
                        }
                    }
                    if (["ETH", "BNB", "tBNB"].includes(outputType) && inputType == "SRG20") {
                        var contract = GetMultiSendContract();
                        var allowance = Number(await inputToken.contractChain.methods.allowance(account, contract._address).call());
                        if (allowance <= 0) {
                            $("#btn-approve").show();
                            $("#btn-connect2").hide();
                            $("#btn-swap").hide();
                        }
                    }
                }
            }
            catch (error) {
                console.log(error);
            }
        }

        async function CheckAmountOutReverse() {
            var value = $("#outputField").val();
            if (inputToken.ca == "") { return; }
            if (value == "") { return; }
            var inputType = GetCAType(inputToken.ca);
            var outputType = GetCAType(outputToken.ca);
            var result = 0;
            var rounding = 2;

            try {
                switch (outputType) {
                    case "BNB":
                    case "tBNB":
                    case "ETH":
                        var multicall = inputType == "SRG20" ? true : false;
                        if (multicall) {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei(value)).call();
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(SRGOut).call();
                            var decimals = await GetInputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var SRGOut = await contractSurgeNW.methods.getTokenAmountOut(web3.utils.toWei(value)).call();
                            var decimals = await GetInputDecimals();
                            result = Number(SRGOut) / Math.pow(10, decimals);
                        }
                        break;
                    case "SRG":
                        if (inputType == "SRG20") {
                            var decimals2 = await GetOutputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals2)));
                            var TokenOut = await outputToken.contractChain.methods.getTokenAmountOut(valueInput.toString()).call();
                            var decimals = await GetInputDecimals();
                            result = Number(TokenOut) / Math.pow(10, decimals);
                        } else {
                            var decimals = await GetOutputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut(valueInput.toString()).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        }
                        break;
                    case "SRG20":
                        var multicall = inputType == "BNB" || inputType == "ETH" ? true : false;
                        if (multicall) {
                            var decimals = await GetOutputDecimals();
                            var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                            var SRGOut = await outputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                            var BNBOut = await contractSurgeNW.methods.getBNBAmountOut(SRGOut).call();
                            result = Number(web3.utils.fromWei(BNBOut));
                            rounding = 5;
                        } else {
                            if (inputType !== "SRG20") {
                                var decimals = await GetOutputDecimals();
                                var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                                var SRGOut = await outputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                                var decimals2 = await GetInputDecimals();
                                result = Number(SRGOut) / Math.pow(10, decimals2);
                            } else {
                                var decimals = await GetInputDecimals();
                                var valueInput = new bigInt(Math.floor(Number(value) * Math.pow(10, decimals)));
                                var SRGOut = await outputToken.contractChain.methods.getsrgAmountOut(valueInput.toString()).call();
                                var decimals2 = await GetOutputDecimals();
                                var TokenOut = await inputToken.contractChain.methods.getTokenAmountOut(SRGOut).call();
                                result = Number(TokenOut) / Math.pow(10, decimals2);
                            }
                        }
                        break;
                }
            } catch (error) {
                ShowError(error.message);
            }

            if (result <= 0) {
                $("#inputField").val("");
            } else {
                $("#inputField").val(result.toFixed(4));
            }
            return result;
        }

        async function UpdatePrices() {
            try {
                if (inputToken.ca == "") { return; }
                LoadAmountsOutTooltip();
                CheckAmountOut();
            }
            catch { }

            setTimeout(function () { UpdatePrices() }, 15000);
        }

        function SwitchCurrency(ca, name, symbol, balance, img) {
            if (inputToken.ca == "") { return; }
            var id = selection == 0 ? `id="inputField"` : `id="outputField"`;
            var html = `<input ${id} type="text" class="form-control" placeholder="0.00" aria-label="Recipient's username" aria-describedby="basic-addon2">
                                            <div class="input-group-append">
                                                <span onclick="OpenTokenWindow(${selection});" class="input-group-text fw-700 cp">${symbol}<img src="${img}" /></span>
                                            </div>`;

            var inputVal = $("#inputField").val();
            $("#inputSearch").val("");
            InputSearchChanged();

            if (ca == inputToken.ca && selection == 1) {
                SwitchInputOutput();
                $("#selectionModal").modal("hide");
                return;
            }
            if (ca == outputToken.ca && selection == 0) {
                SwitchInputOutput();
                $("#selectionModal").modal("hide");
                return;
            }

            if (selection == 0) {
                $("#inputForm").html(html);
                inputToken.ca = ca;
                inputToken.name = name;
                inputToken.symbol = symbol;
                inputToken.balance = balance;
                inputToken.img = img;
                inputToken.contract = new web3.eth.Contract(GetContractABI(ca), ca);
                inputToken.contractChain = GetChainContract(ca);
            } else {
                $("#outputForm").html(html);
                outputToken.ca = ca;
                outputToken.name = name;
                outputToken.symbol = symbol;
                outputToken.balance = balance;
                outputToken.img = img;
                outputToken.contract = new web3.eth.Contract(GetContractABI(ca), ca);
                outputToken.contractChain = GetChainContract(ca);
            }
            $("#selectionModal").modal("hide");

            if (outputToken.ca !== "" && inputToken.ca !== "") {
                $("#btn-swap").attr('disabled', false);
            } else {
                $("#btn-swap").attr('disabled', true);
            }

            $("#inputField").off();
            $("#inputField").on("input", async function () {
                CheckAmountOut();
            });
            $("#outputField").off();
            $("#outputField").on("input", async function () {
                CheckAmountOutReverse();
            });

            $("#balanceInput").text(inputToken.balance.toFixed(4));
            $("#balanceOutput").text(outputToken.balance.toFixed(4));
            $("#inputField").val(inputVal);
            LoadAmountsOutTooltip();
            CheckAmountOut();
            CheckApproval();
        }

        function SwitchInputOutput() {
            var _input = inputToken;
            var _output = outputToken;
            var outputVal = $("#outputField").val();

            var htmlInput = `<input id="inputField" type="text" class="form-control" placeholder="0.00" aria-label="Recipient's username" aria-describedby="basic-addon2">
                                            <div class="input-group-append">
                                                <span onclick="OpenTokenWindow(0);" class="input-group-text fw-700 cp">${_output.symbol}<img src="${_output.img}" /></span>
                                            </div>`;
            var htmlOutput = `<input id="outputField" type="text" class="form-control" placeholder="0.00" aria-label="Recipient's username" aria-describedby="basic-addon2">
                                            <div class="input-group-append">
                                                <span onclick="OpenTokenWindow(1);" class="input-group-text fw-700 cp">${_input.symbol}<img src="${_input.img}" /></span>
                                            </div>`;

            outputToken = _input;
            inputToken = _output;
            $("#inputForm").html(htmlInput);
            $("#outputForm").html(htmlOutput);
            $("#inputField").val(outputVal);
            LoadAmountsOutTooltip();
            $("#inputField").off();
            $("#inputField").on("input", async function () {
                CheckAmountOut();
            });
            $("#outputField").off();
            $("#outputField").on("input", async function () {
                CheckAmountOutReverse();
            });
            CheckAmountOut();
            CheckApproval();

            $("#balanceInput").text(inputToken.balance.toFixed(4));
            $("#balanceOutput").text(outputToken.balance.toFixed(4));
        }

        function OpenTokenWindow(id) {
            selection = id;
            $("#selectionModal").modal("show");
        }

        async function InputSearchChanged() {
            if (inputToken.ca == "") { return; }
            var value = $("#inputSearch").val();
            if (web3.utils.isAddress(value)) {
                var tokenInfo = await GetTokenInfoByCa(value);
                var dnone = IsInDefault(tokenInfo.ca) ? "d-none" : "";
                var click = dnone !== "" ? `onclick="SwitchCurrency('${tokenInfo.ca}', '${tokenInfo.name}', '${tokenInfo.symbol}', ${tokenInfo.balance}, 'img/unknown2.png')"` : "";
                if (tokenInfo !== null) {
                    $("#tokenSearches").html(`
                                        <div class="d-flex flex-row justify-content-between tokenrow cp p-2 px-3" ${click}>
                                            <div class="d-flex flex-row" onclick="SwitchCurrency('${tokenInfo.ca}', '${tokenInfo.name}', '${tokenInfo.symbol}', ${tokenInfo.balance}, 'img/unknown2.png')">
                                                <img class="search-icon" src="img/unknown2.png" />
                                                <div class="flex-column">
                                                    <h6 class="mb-0 text-white">${tokenInfo.symbol}</h6>
                                                    <p class="mb-0 text-white-50">${tokenInfo.name}</p>
                                                </div>
                                            </div>
                                            <div class="d-flex flex-row justify-content-start align-items-center">
                                                <p class="search-balance mb-0" style="margin-top:2.5px !important; margin-right:17.5px !important;" onclick="SwitchCurrency('${tokenInfo.ca}', '${tokenInfo.name}', '${tokenInfo.symbol}', ${tokenInfo.balance}, 'img/unknown2.png')">${tokenInfo.balance}</p>
                                                <button class="${dnone} btn btn-outline-success" onclick="OpenImport('${tokenInfo.ca}', '${tokenInfo.symbol}', '${tokenInfo.name}', ${tokenInfo.balance});">Save</button>
                                            </div>
                                        </div>
                                        `);
                } else {
                    $("#tokenSearches").html(`<p class="text-white-50 text-center mt-3">No results found.</p>`);
                }
            }
            if (value == "") {
                var html = ``;

                for (let token in defaultTokens) {
                    var item = defaultTokens[token];
                    var _balance = await GetBalance(item.ca);
                    html += `
                                        <div class="d-flex flex-row justify-content-between tokenrow cp p-2 px-3" onclick="SwitchCurrency('${item.ca}', '${item.name}', '${item.symbol}', ${_balance}, '${item.img}')">
                                            <div class="d-flex flex-row">
                                                <img class="search-icon" src="${item.img}" />
                                                <div class="flex-column">
                                                    <h6 class="mb-0 text-white">${item.symbol}</h6>
                                                    <p class="mb-0 text-white-50">${item.name}</p>
                                                </div>
                                            </div>
                                            <p class="search-balance">${formatter.format(_balance)}</p>
                                        </div>`;
                }

                $("#tokenSearches").html(html);
            }
        }

        async function SetValueInput(percentage) {
            var val;
            if (percentage == 1.00) {
                val = Math.floor(inputToken.balance * 10000) / 10000;
            } else {
                val = inputToken.balance * percentage;
            }

            $("#inputField").val(val.toFixed(4));
            CheckAmountOut();
        }
        async function SetValueOutput(percentage) {
            var val;

            if (percentage == 1.00) {
                val = Math.floor(outputToken.balance * 10000) / 10000;
            } else {
                val = outputToken.balance * percentage;
            }
            $("#outputField").val(val.toFixed(4));
            CheckAmountOutReverse();
        }
    </script>
</body>
</html>